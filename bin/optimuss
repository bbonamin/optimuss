#!/usr/bin/env ruby
require 'gli'
require 'optimuss'
include GLI::App

program_desc 'A prime number and multiplication table generator'

version Optimuss::VERSION

subcommand_option_handling :normal
arguments :strict

desc 'Prints a multiplication table with the first 10 primes'
command :prime_table do |c|
  c.action do
    primes = Optimuss::PrimeGenerator.take(count: 10)
    table = Optimuss::MultiplicationTable.new(collection: primes)
    table.generate!
    puts Optimuss::Renderer.new.render(table: table.product)
  end
end

desc 'Prints the prime number at the given location'

command :prime_at do |c|
  c.flag [:p, :position, 'position']

  c.action do |_, args|
    raise '--position is required' if args[:position].nil?
    prime = Optimuss::PrimeGenerator.at(position: args[:position].to_i)

    puts "The prime in the position ##{args[:position]} is #{prime}"
  end
end

exit run(ARGV)
